(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6393f460"],{1276:function(e,t,r){"use strict";var s=r("d784"),i=r("44e7"),o=r("825a"),n=r("1d80"),a=r("4840"),l=r("8aa5"),u=r("50c4"),c=r("14c3"),d=r("9263"),m=r("d039"),f=[].push,h=Math.min,p=4294967295,g=!m((function(){return!RegExp(p,"y")}));s("split",2,(function(e,t,r){var s;return s="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,r){var s=String(n(this)),o=void 0===r?p:r>>>0;if(0===o)return[];if(void 0===e)return[s];if(!i(e))return t.call(s,e,o);var a,l,u,c=[],m=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),h=0,g=new RegExp(e.source,m+"g");while(a=d.call(g,s)){if(l=g.lastIndex,l>h&&(c.push(s.slice(h,a.index)),a.length>1&&a.index<s.length&&f.apply(c,a.slice(1)),u=a[0].length,h=l,c.length>=o))break;g.lastIndex===a.index&&g.lastIndex++}return h===s.length?!u&&g.test("")||c.push(""):c.push(s.slice(h)),c.length>o?c.slice(0,o):c}:"0".split(void 0,0).length?function(e,r){return void 0===e&&0===r?[]:t.call(this,e,r)}:t,[function(t,r){var i=n(this),o=void 0==t?void 0:t[e];return void 0!==o?o.call(t,i,r):s.call(String(i),t,r)},function(e,i){var n=r(s,e,this,i,s!==t);if(n.done)return n.value;var d=o(e),m=String(this),f=a(d,RegExp),b=d.unicode,v=(d.ignoreCase?"i":"")+(d.multiline?"m":"")+(d.unicode?"u":"")+(g?"y":"g"),y=new f(g?d:"^(?:"+d.source+")",v),E=void 0===i?p:i>>>0;if(0===E)return[];if(0===m.length)return null===c(y,m)?[m]:[];var P=0,A=0,_=[];while(A<m.length){y.lastIndex=g?A:0;var w,x=c(y,g?m:m.slice(A));if(null===x||(w=h(u(y.lastIndex+(g?0:A)),m.length))===P)A=l(m,A,b);else{if(_.push(m.slice(P,A)),_.length===E)return _;for(var I=1;I<=x.length-1;I++)if(_.push(x[I]),_.length===E)return _;A=P=w}}return _.push(m.slice(P)),_}]}),!g)},"159b":function(e,t,r){var s=r("da84"),i=r("fdbc"),o=r("17c2"),n=r("9112");for(var a in i){var l=s[a],u=l&&l.prototype;if(u&&u.forEach!==o)try{n(u,"forEach",o)}catch(c){u.forEach=o}}},"17c2":function(e,t,r){"use strict";var s=r("b727").forEach,i=r("a640"),o=r("ae40"),n=i("forEach"),a=o("forEach");e.exports=n&&a?[].forEach:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}},"365c":function(e,t,r){"use strict";r.d(t,"i",(function(){return d})),r.d(t,"m",(function(){return m})),r.d(t,"a",(function(){return f})),r.d(t,"d",(function(){return h})),r.d(t,"f",(function(){return p})),r.d(t,"b",(function(){return g})),r.d(t,"c",(function(){return b})),r.d(t,"k",(function(){return v})),r.d(t,"l",(function(){return y})),r.d(t,"e",(function(){return E})),r.d(t,"g",(function(){return P})),r.d(t,"h",(function(){return A})),r.d(t,"j",(function(){return _}));r("caad"),r("0d03"),r("d3b7"),r("e25e"),r("2532");var s,i=r("bc3a"),o=r.n(i),n=r("4360"),a=r("5c96"),l=o.a.create({baseURL:"http://zsjustn.top",timeout:8e3});function u(e){if(!e)return 0;var t=n["a"].getters.num,r=(new Date).getTime()-e;return r=parseInt(r/1e3/60,10),console.log(r),Boolean(r>=t)}l.interceptors.request.use((function(e){console.log("config: ",e);var t=n["a"].getters.countdown;return u(t)||n["a"].commit("index/SET_COUNTDOWN"),s=a["Loading"].service({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),n["a"].getters.userInfo&&(e.headers["zsid"]=n["a"].getters.userInfo._id),e}),(function(e){return console.log(e),Promise.reject()})),l.interceptors.response.use((function(e){if(s.close(),200===e.status)return e.data;Promise.reject()}),(function(e){return console.log(e.response),s.close(),e.message.includes("timeout")?Promise.reject("请求超时, 请稍后重试"):Promise.reject(e)}));var c=l,d=function(e){return c({url:"/admin/login",method:"post",data:e})},m="http://zsjustn.top/admin/upload",f=function(e){return c({url:"/admin/addCustomer",method:"post",data:e})},h=function(e){return c({url:"/admin/getLoginLog",method:"get",params:e})},p=function(e){return c({url:"/admin/getOwnerList",method:"get",params:e})},g=function(e){return c({url:"/admin/deleteOwner",method:"post",data:e})},b=function(e){return c({url:"/api/deleteUser",method:"post",data:e})},v=function(e){return c({url:"/api/upDateUser",method:"post",data:e})},y=function(e){return c({url:"/admin/updateOwner",method:"post",data:e})},E=function(e){return c({url:"/admin/getOperationLog",method:"get",params:e})},P=function(e){return c({url:"/api/getUserList",method:"get",params:e})},A=function(e){return c({url:"/admin/getUserListByAdmin",method:"get",params:e})},_=function(e){return c({url:"/api/setAdmin",method:"post",data:e})}},4160:function(e,t,r){"use strict";var s=r("23e7"),i=r("17c2");s({target:"Array",proto:!0,forced:[].forEach!=i},{forEach:i})},6943:function(e,t,r){},a434:function(e,t,r){"use strict";var s=r("23e7"),i=r("23cb"),o=r("a691"),n=r("50c4"),a=r("7b0b"),l=r("65f0"),u=r("8418"),c=r("1dde"),d=r("ae40"),m=c("splice"),f=d("splice",{ACCESSORS:!0,0:0,1:2}),h=Math.max,p=Math.min,g=9007199254740991,b="Maximum allowed length exceeded";s({target:"Array",proto:!0,forced:!m||!f},{splice:function(e,t){var r,s,c,d,m,f,v=a(this),y=n(v.length),E=i(e,y),P=arguments.length;if(0===P?r=s=0:1===P?(r=0,s=y-E):(r=P-2,s=p(h(o(t),0),y-E)),y+r-s>g)throw TypeError(b);for(c=l(v,s),d=0;d<s;d++)m=E+d,m in v&&u(c,d,v[m]);if(c.length=s,r<s){for(d=E;d<y-s;d++)m=d+s,f=d+r,m in v?v[f]=v[m]:delete v[f];for(d=y;d>y-s+r;d--)delete v[d-1]}else if(r>s)for(d=y-s;d>E;d--)m=d+s-1,f=d+r-1,m in v?v[f]=v[m]:delete v[f];for(d=0;d<r;d++)v[d+E]=arguments[d+2];return v.length=y-s+r,c}})},adff:function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"crumbs"},[r("el-breadcrumb",{attrs:{separator:"/"}},[r("el-breadcrumb-item",[r("i",{staticClass:"el-icon-lx-calendar"}),e._v(" "+e._s(e.isEdit?"修改信息":"添加信息")+" ")]),r("el-breadcrumb-item",[e._v(e._s(e.isEdit?"修改业主":"添加业主"))])],1)],1),r("div",{staticClass:"container"},[r("div",{staticClass:"form-box",staticStyle:{width:"100%"}},[r("el-form",{ref:"form",attrs:{rules:e.rules,"label-position":"right",model:e.form,"label-width":"80px"}},[r("div",{staticClass:"one_row"},[r("el-form-item",{attrs:{label:"业主姓名",prop:"userName"}},[r("el-input",{attrs:{clearable:""},model:{value:e.form.userName,callback:function(t){e.$set(e.form,"userName",t)},expression:"form.userName"}})],1),r("el-form-item",{staticClass:"row_right",attrs:{label:"业主电话",prop:"userPhoen"}},[r("el-input",{attrs:{clearable:""},model:{value:e.form.userPhoen,callback:function(t){e.$set(e.form,"userPhoen",t)},expression:"form.userPhoen"}})],1)],1),r("div",{staticClass:"one_row"},[r("el-form-item",{attrs:{label:"业主地址",prop:"userAddress"}},[r("el-input",{attrs:{clearable:""},model:{value:e.form.userAddress,callback:function(t){e.$set(e.form,"userAddress",t)},expression:"form.userAddress"}})],1),r("el-form-item",{staticClass:"row_right",attrs:{label:"水工姓名",prop:"hydraulicName"}},[r("el-input",{attrs:{clearable:""},model:{value:e.form.hydraulicName,callback:function(t){e.$set(e.form,"hydraulicName",t)},expression:"form.hydraulicName"}})],1)],1),r("div",{staticClass:"one_row"},[r("el-form-item",{attrs:{label:"水工电话",prop:"hydraulicPhoen"}},[r("el-input",{attrs:{clearable:""},model:{value:e.form.hydraulicPhoen,callback:function(t){e.$set(e.form,"hydraulicPhoen",t)},expression:"form.hydraulicPhoen"}})],1),r("el-form-item",{staticClass:"row_right",attrs:{label:"质保卡号",prop:"qualityAssuranceNum"}},[r("el-input",{attrs:{clearable:""},model:{value:e.form.qualityAssuranceNum,callback:function(t){e.$set(e.form,"qualityAssuranceNum",t)},expression:"form.qualityAssuranceNum"}})],1)],1),r("div",{staticClass:"one_row"},[r("el-form-item",{attrs:{label:"水工积分",prop:"hydraulicIntegral"}},[r("el-input",{attrs:{clearable:""},model:{value:e.form.hydraulicIntegral,callback:function(t){e.$set(e.form,"hydraulicIntegral",t)},expression:"form.hydraulicIntegral"}})],1),r("el-form-item",{staticClass:"row_right",attrs:{label:"经销商"}},[r("el-input",{attrs:{clearable:""},model:{value:e.form.dealers,callback:function(t){e.$set(e.form,"dealers",t)},expression:"form.dealers"}})],1)],1),r("div",{staticClass:"one_row"},[r("el-form-item",{attrs:{label:"上传时间"}},[r("el-input",{attrs:{disabled:""},model:{value:e.form.uploadTime,callback:function(t){e.$set(e.form,"uploadTime",t)},expression:"form.uploadTime"}})],1),r("el-form-item",{staticClass:"row_right",attrs:{label:"操作账号"}},[r("el-input",{attrs:{disabled:""},model:{value:e.form.operatingAccount,callback:function(t){e.$set(e.form,"operatingAccount",t)},expression:"form.operatingAccount"}})],1)],1),r("el-row",{staticClass:"el_row_box",attrs:{gutter:20}},[e._l(e.needEditUser.uploadPhotos,(function(t,s){return r("el-col",{key:s,attrs:{span:8}},[r("div",{staticClass:"grid-content bg-purple"},[r("el-image",{staticClass:"el-img",attrs:{lazy:"",fit:"cover",src:t.path,"preview-src-list":e.splitPhotos(e.needEditUser.uploadPhotos)}}),r("i",{staticClass:"el-icon-delete",on:{click:function(t){return e.deleteImg(s)}}}),r("span",{staticClass:"count"},[e._v(e._s(t.count))])],1)])})),r("i",{staticClass:"el-icon-arrow-left",on:{click:e.rollLeft}}),r("i",{staticClass:"el-icon-arrow-right",on:{click:e.rollRight}})],2),r("el-form-item",{attrs:{label:"上传图片"}},[r("el-upload",{staticClass:"upload-demo",attrs:{target:"tg",name:"myfile",id:"myfile",drag:"",action:e.uploadUrl,"list-type":"picture",multiple:"","file-list":e.fileList,"on-success":e.uploadSuccess,"on-error":e.uploadError,"before-upload":e.beforeUpload}},[r("i",{staticClass:"el-icon-upload"}),r("div",{staticClass:"el-upload__text"},[e._v(" 将文件拖到此处，或 "),r("em",[e._v("点击上传")])]),r("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件")])])],1),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("form")}}},[e._v(e._s(e.isEdit?"立即修改":"立即添加"))]),e.isEdit?e._e():r("el-button",{on:{click:function(t){return e.resetForm("form")}}},[e._v("重置")])],1)],1)],1)])])},i=[],o=(r("99af"),r("4160"),r("caad"),r("a434"),r("0d03"),r("b0c0"),r("ac1f"),r("1276"),r("159b"),r("53ca")),n=r("365c"),a={name:"addmessage",data:function(){return{form:{userName:"",userPhoen:"",userAddress:"",hydraulicName:"",hydraulicPhoen:"",qualityAssuranceNum:"",hydraulicIntegral:"",dealers:"",uploadTime:(new Date).toLocaleString(),operatingAccount:"",createrId:""},rules:{userName:[{required:!0,message:"请输入业主姓名",trigger:"blur"},{min:2,max:5,message:"长度在 2 到 5 个字符",trigger:"blur"}],userPhoen:[{required:!0,message:"请输入业主电话",trigger:"blur"},{min:11,max:11,message:"长度需11个字符",trigger:"blur"}],hydraulicName:[{required:!0,message:"请输入水工姓名",trigger:"blur"},{min:2,max:5,message:"长度在 2 到 5 个字符",trigger:"blur"}],hydraulicPhoen:[{required:!0,message:"请输入水工电话",trigger:"blur"},{min:11,max:11,message:"长度需11个字符",trigger:"blur"}],userAddress:[{required:!0,message:"请输入地址",trigger:"blur"}],qualityAssuranceNum:[{required:!0,message:"请输入质保卡号",trigger:"blur"}],hydraulicIntegral:[{required:!0,message:"请输入水工积分",trigger:"blur"}]},uploadUrl:n["m"],fileList:[],needEditUser:{},isEdit:!1}},mounted:function(){this.form.operatingAccount=this.userInfo.nickname,this.form.createrId=this.userInfo._id},computed:{userInfo:function(){return this.$store.getters.userInfo||""},editorData:function(){return this.$store.getters.editorData}},activated:function(){this.reset(),this.editorData&&!this.isEdit&&(this.needEditUser=this.editorData,this.isEdit=!0,this.init(this.needEditUser))},methods:{reset:function(){this.form={userName:"",userPhoen:"",userAddress:"",hydraulicName:"",hydraulicPhoen:"",qualityAssuranceNum:"",hydraulicIntegral:"",dealers:"",uploadTime:(new Date).toLocaleString(),operatingAccount:this.userInfo.nickname,createrId:this.userInfo._id||""},this.fileList=[],this.needEditUser={},this.isEdit=!1},submitForm:function(e){var t=this;this.$refs[e].validate((function(r){if(!r)return console.log("error submit!!"),!1;var s={customerName:t.form.userName,customerMobil:t.form.userPhoen,customerAdress:t.form.userAddress,hydraulicName:t.form.hydraulicName,hydraulicMobil:t.form.hydraulicPhoen,qualityAssuranceNum:t.form.qualityAssuranceNum,hydraulicIntegral:t.form.hydraulicIntegral,dealers:t.form.dealers,operatingAccount:t.form.operatingAccount,uploadPhotos:t.fileListReduce(),createrId:t.form.createrId};if(t.isEdit)return s._id=t.needEditUser._id,void Object(n["l"])(s).then((function(r){1===r.Code?(t.$router.push("/"),t.$refs[e].resetFields(),t.fileList=[],t.$message.success("修改用户数据成功")):t.$message.error(r.Message)}))["catch"]((function(e){t.$message.error(e||"updateOwner error")}));Object(n["a"])(s).then((function(r){1===r.Code?(t.$router.push("/"),t.$refs[e].resetFields(),t.fileList=[],t.$message.success("添加成功")):t.$message.error(r.Message)}))["catch"]((function(e){t.$message.error(e||"addCustomer error")}))}))},resetForm:function(e){this.$refs[e].resetFields()},uploadError:function(e,t,r){console.log(e),this.$message.error(t.name+"上传失败")},uploadSuccess:function(e,t,r){1===e.Code&&(this.fileList=r,console.log(r))},beforeUpload:function(e){console.log(e);var t=["png","PNG","jpg","JPG","jpeg","gif"],r=e.name.split(".");if(r=r[r.length-1],!t.includes(r))return this.$message({message:"请不要上传除图片外其他文件",type:"warning"}),!1;console.log("ok");for(var s=0;s<this.fileList.length;s++)if(this.fileList[s]["name"]===e["name"])return this.$message({message:"请不要重复上传",type:"warning"}),!1},fileListReduce:function(){for(var e=this.fileList,t=[],r=0;r<e.length;r++)t.push(e[r]["response"]["Data"]);return this.isEdit&&(t=t.concat(this.needEditUser.uploadPhotos)),t},init:function(e){this.form={userName:e.customerName,userPhoen:e.customerMobil,userAddress:e.customerAdress,hydraulicName:e.hydraulicName,hydraulicPhoen:e.hydraulicMobil,qualityAssuranceNum:e.qualityAssuranceNum,hydraulicIntegral:e.hydraulicIntegral,dealers:e.dealers,uploadTime:e.createTime,operatingAccount:e.operatingAccount,createrId:e.createrId};for(var t=this.needEditUser.uploadPhotos,r=0;r<t.length;r++)t[r].count=r+1;this.needEditUser.uploadPhotos=t},deleteImg:function(e){var t=this.needEditUser.uploadPhotos[e]["count"],r=this.needEditUser.uploadPhotos;r.splice(e,1);for(var s=0;s<r.length;s++)r[s]["count"]>t&&r[s]["count"]--;this.needEditUser.uploadPhotos=r},rollRight:function(){if(console.log("滚动右边"),this.needEditUser.uploadPhotos.length>3){var e=this.needEditUser.uploadPhotos[this.needEditUser.uploadPhotos.length-1];this.needEditUser.uploadPhotos.pop(),this.needEditUser.uploadPhotos.unshift(e)}},rollLeft:function(){if(console.log("滚动左边"),this.needEditUser.uploadPhotos.length>3){var e=this.needEditUser.uploadPhotos[0];this.needEditUser.uploadPhotos.shift(),this.needEditUser.uploadPhotos.push(e)}},splitPhotos:function(e){var t=[];return e&&"object"==Object(o["a"])(e)&&e.forEach((function(e){t.push(e.path)})),t}},beforeDestroy:function(){console.log("beforeDestroy"),this.$store.commit("index/SET_EDITORDATA",null)},destroyed:function(){console.log("destroyed"),this.$store.commit("index/SET_EDITORDATA",null)}},l=a,u=(r("e5d6"),r("2877")),c=Object(u["a"])(l,s,i,!1,null,null,null);t["default"]=c.exports},b0c0:function(e,t,r){var s=r("83ab"),i=r("9bf2").f,o=Function.prototype,n=o.toString,a=/^\s*function ([^ (]*)/,l="name";s&&!(l in o)&&i(o,l,{configurable:!0,get:function(){try{return n.call(this).match(a)[1]}catch(e){return""}}})},e5d6:function(e,t,r){"use strict";var s=r("6943"),i=r.n(s);i.a}}]);